#! SAPT0 cc-pVDZ computation of the ethene-ethyne interaction energy, using the cc-pVDZ-JKFIT RI basis for SCF
#! and cc-pVDZ-RI for SAPT.  Monomer geometries are specified using Cartesian coordinates.

memory 250 mb

Eref = {"SAPT ELST ENERGY":  -0.00007808151, # TEST
        "SAPT EXCH ENERGY":   0.00030618033, # TEST
        "SAPT IND ENERGY":    0.00000124532} # TEST

molecule dimer {
  Ne
  --
  Ar 1 6.5
  units bohr
}

eps_homo_pbe0_ar=-0.440936                 # HOMO(Ar)/PBE0 functional
eps_homo_pbe0_ne=-0.589207                 # HOMO(Ne)/PBE0
ip_ar=0.5792                               # exp. ionisation potential
ip_ne=0.7925                               # exp. ionisation potential
shift_ar=ip_ar+eps_homo_pbe0_ar            # shift for bulk xc potential (Ar)
shift_ne=ip_ne+eps_homo_pbe0_ne            # shift for bulk xc potential (Ne)

set {
    basis         cc-pvdz
    scf_type      df
    sapt_dft_grac_shift_a 0.203293
    sapt_dft_grac_shift_b 0.138264
    DFT_SPHERICAL_POINTS 302
    DFT_RADIAL_POINTS    50
    e_convergence 1e-8
    d_convergence 1e-8
}

energy('sapt(dft)', molecule=dimer)

for k, v in Eref.items():                         # TEST
    compare_values(v, psi4.get_variable(k), 6, k) # TEST
